{% load i18n %}
<style>
    .skill-rating-modal-body {
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 24px 18px;
        background: #fff;
    }
    .skill-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
    }
    .skill-row .skill-label {
        flex: 1 1 60%;
        font-weight: 500;
        text-align: left;
    }
    .skill-row .skill-input {
        flex: 0 0 180px;
        text-align: right;
    }
    .category-title {
        font-weight: bold;
        font-size: 1.1em;
        margin-top: 18px;
        margin-bottom: 8px;
    }
</style>



<div class="oh-modal__dialog-header">
    <span class="oh-modal__dialog-title" id="skillRatingModalLabel">
        <h5>{% trans 'Skill Rating' %} - {{candidate_application.name|default:"Unknown Candidate"}}</h5>
    </span>
    <!-- <button class="oh-modal__close" aria-label="Close"><ion-icon name="close-outline"></ion-icon></button> -->
</div>

<div class="oh-modal__dialog-body skill-rating-modal-body">
    <form
        hx-post="{% url 'candidate-application-skill-rating' candidate_application.id %}"
        hx-target="#createTarget"
        hx-encoding="multipart/form-data"
        id="skillRatingForm"
    >
        {% csrf_token %}
        <input type="hidden" name="stage_id" value="{{ stage.id }}">
        
        <!-- Technical Skills -->
        {% if technical_skills %}
        <div class="category-title">{% trans 'Technical Skills' %}</div>
        {% for skill in technical_skills %}
        <div class="skill-row">
            <div class="skill-label">{{ skill.title }}</div>
            <div class="skill-input">
                <input type="number" 
                       name="technical_ratings" 
                       step="0.1" 
                       min="0.0" 
                       max="5.0" 
                       class="oh-input w-100" 
                       placeholder="0.0 - 5.0" 
                       value="{% for rating in existing_ratings %}{% if rating.skill_name == skill.title and rating.skill_category == 'technical' %}{{ rating.rating }}{% endif %}{% endfor %}">
                <input type="hidden" name="technical_skills" value="{{ skill.title }}">
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="alert alert-info">
            <strong>{% trans 'No Technical Skills' %}</strong><br>
            No technical skills are configured for this recruitment.
        </div>
        {% endif %}

        <!-- Non-Technical Skills -->
        {% if non_technical_skills %}
        <div class="category-title">{% trans 'Non-Technical Skills' %}</div>
        {% for skill in non_technical_skills %}
        <div class="skill-row">
            <div class="skill-label">{{ skill.title }}</div>
            <div class="skill-input">
                <input type="number" 
                       name="non_technical_ratings" 
                       step="0.1" 
                       min="0.0" 
                       max="5.0" 
                       class="oh-input w-100" 
                       placeholder="0.0 - 5.0" 
                       value="{% for rating in existing_ratings %}{% if rating.skill_name == skill.title and rating.skill_category == 'non_technical' %}{{ rating.rating }}{% endif %}{% endfor %}">
                <input type="hidden" name="non_technical_skills" value="{{ skill.title }}">
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="alert alert-info">
            <strong>{% trans 'No Non-Technical Skills' %}</strong><br>
            No non-technical skills are configured for this recruitment.
        </div>
        {% endif %}

        <!-- Note -->
        <div class="form-group mb-3 mt-4">
            <label for="note" class="fw-bold">{% trans 'Note' %}</label>
            <textarea name="notes" id="note" class="oh-input w-100" rows="3" placeholder="{% trans 'Add note about this candidate...' %}">{{ existing_notes }}</textarea>
        </div>

        <div class="modal-footer d-flex flex-row-reverse mt-3">
            <button type="submit" class="oh-btn oh-btn--secondary">
                {% trans 'Save Rating' %}
            </button>
        </div>
    </form>
</div> 