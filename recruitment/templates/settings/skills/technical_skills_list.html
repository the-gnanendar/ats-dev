{% load i18n %}
<div class="oh-sticky-table">
	<div class="oh-sticky-table__table oh-table--sortable">
		<div class="oh-sticky-table__thead">
			<div class="oh-sticky-table__tr">
				<div class="oh-sticky-table__th" style="width:20px">{% trans "Sl.No" %}</div>
				<div class="oh-sticky-table__th" align="center">{% trans "Technical Skill" %}</div>
				{% if perms.recruitment.change_recruitment or perms.recruitment.delete_recruitment or perms.recruitment.add_recruitment %}
					<div class="oh-sticky-table__th" align="center">{% trans "Actions" %}</div>
				{% endif %}
			</div>
		</div>
		<div class="oh-sticky-table__tbody">
			{% for skill in technical_skills %}
			<div class="oh-sticky-table__tr" draggable="true">
				<div class="oh-sticky-table__td">{{forloop.counter}}</div>
				<div class="oh-sticky-table__td" align="center">{{skill.title}}</div>
				{% if perms.recruitment.change_recruitment or perms.recruitment.delete_recruitment or perms.recruitment.add_recruitment %}
					<div class="oh-sticky-table__td" align="center">
						<div class="oh-btn-group">
							{% if perms.recruitment.change_recruitment %}
								<button class="oh-btn oh-btn--light-bkg w-50" data-toggle="oh-modal-toggle" data-target="#objectCreateModal" hx-get="{% url 'create-technical-skills' %}?instance_id={{skill.id}}" hx-target="#objectCreateModalTarget">
									<ion-icon name="create-outline" class="me-1"></ion-icon>
									{% trans "Edit" %}
								</button>
							{% endif %}
							{% if perms.recruitment.delete_recruitment %}
								<button class="oh-btn oh-btn--danger-outline oh-btn--light-bkg w-50" onclick="deleteSkill('{{skill.id}}', 'technical')">
									<ion-icon name="trash-outline" class="me-1"></ion-icon>
									{% trans "Delete" %}
								</button>
							{% endif %}
						</div>
					</div>
				{% endif %}
			</div>
			{% endfor %}
		</div>
	</div>
</div>

<script>
	function deleteSkill(skillId, skillType) {
		if (confirm("{% trans 'Are you sure you want to delete this skill?' %}")) {
			$.ajax({
				url: "{% url 'delete-skills' %}",
				type: "POST",
				data: {
					skill_id: skillId,
					skill_type: skillType,
					csrfmiddlewaretoken: "{{ csrf_token }}"
				},
				success: function(response) {
					if (response.success) {
						location.reload();
					} else {
						alert("{% trans 'Error deleting skill' %}");
					}
				},
				error: function() {
					alert("{% trans 'Error deleting skill' %}");
				}
			});
		}
	}
</script> 